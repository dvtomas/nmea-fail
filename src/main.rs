extern crate nmea;

use std::io::{BufRead, BufReader, Cursor, Read};
use nmea::Nmea;

fn main() {
		let mut nmea = Nmea::new();

		let mut input = BufReader::new(Cursor::new(TEST_DATA));

		for _ in 0..100 {
				let mut buffer = String::new();
				let size = input.read_line(&mut buffer).unwrap();
				eprintln!("buffer = {:?}", buffer);
				if size > 0 {
						if buffer.as_bytes()[0] == b'$' {
								nmea.parse(&buffer);
								println!("{:?}", nmea);
						}
				} else {
						break;
				}
		}
}

const TEST_DATA: &[u8] = br#"
$--GGA,hhmmss.ss,llll.lll,a,yyyyy.yyy,a,x,uu,v.v,w.w,M,x.x,M,,zzzz*hh<CR><LF>
$GNGGA,181604.00,llll.lll,a,yyyy.yyy,a,0,00,99.99,w.w,M,x.x,M,,*72
$GNVTG,,,,,,,,,N*2E
$GNGNS,181604.00,,,,,NN,00,99.99,,,,*59
$GNGGA,181604.00,,,,,0,00,99.99,,,,,,*72
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GPGSV,4,1,13,02,35,291,,03,09,129,,05,14,305,,06,38,226,*7D
$GPGSV,4,2,13,07,56,177,,09,70,067,,16,20,055,,23,41,076,*77
$GPGSV,4,3,13,26,10,030,,29,05,341,,30,26,199,,36,30,158,*7E
$GPGSV,4,4,13,49,32,192,*4D
$GLGSV,3,1,10,66,45,091,,67,67,334,,68,17,297,,75,13,025,*68
$GLGSV,3,2,10,76,49,059,,77,40,156,,78,00,183,,82,15,246,*68
$GLGSV,3,3,10,83,28,298,,84,10,352,*6F
$GNGLL,,,,,181604.00,V,N*5E
$GNGRS,181604.00,1,,,,,,,,,,,,*5A
$GNGRS,181604.00,1,,,,,,,,,,,,*5A
$GNGST,181604.00,0.0000,,,,5773795,5773795,5773794*4F
$GNZDA,181604.00,12,09,2018,00,00*73
$GNGBS,181604.00,,,,,,,*7B
$GNTXT,01,01,02,u-blox AG - www.u-blox.com*4E
$GNTXT,01,01,02,HW UBX-M8030 00080000*60
$GNTXT,01,01,02,EXT CORE 3.01 (107900)*33
$GNTXT,01,01,02,ROM BASE 3.01 (107888)*25
$GNTXT,01,01,02,FWVER=SPG 3.01*46
$GNTXT,01,01,02,PROTVER=18.00*11
$GNTXT,01,01,02,MOD=NEO-M8N-0*67
$GNTXT,01,01,02,FIS=0xC22536 (100111)*28
$GNTXT,01,01,02,GPS;GLO;GAL;BDS*77
$GNTXT,01,01,02,SBAS;IMES;QZSS*49
$GNTXT,01,01,02,GNSS OTP=GPS;GLO*37
$GNTXT,01,01,02,LLC=FFFFFFFF-FFFFFFED-FFFFFFFF-FFFFFFFF-FFFFFF69*23
$GNTXT,01,01,02,ANTSUPERV=AC SD PDoS SR*3E
$GNTXT,01,01,02,ANTSTATUS=OK*25
$GNTXT,01,01,02,PF=3FF*4B
$GNVTG,,,,,,,,,N*2E
$GNGNS,181605.00,,,,,NN,00,99.99,,,,*58
$GNGGA,181605.00,,,,,0,00,99.99,,,,,,*73
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GPGSV,4,1,13,02,35,291,,03,09,129,,05,14,305,,06,38,226,*7D
$GPGSV,4,2,13,07,56,177,,09,70,067,,16,20,055,,23,41,076,*77
$GPGSV,4,3,13,26,10,030,,29,05,341,,30,26,199,,36,30,158,*7E
$GPGSV,4,4,13,49,32,192,*4D
$GLGSV,3,1,10,66,45,091,,67,67,334,,68,17,297,,75,13,025,*68
$GLGSV,3,2,10,76,49,059,,77,40,156,,78,00,183,,82,15,246,*68
$GLGSV,3,3,10,83,28,298,,84,10,352,*6F
$GNGLL,,,,,181605.00,V,N*5F
$GNGRS,181605.00,1,,,,,,,,,,,,*5B
$GNGRS,181605.00,1,,,,,,,,,,,,*5B
$GNGST,181605.00,0.0000,,,,5773795,5773795,5773795*4F
$GNZDA,181605.00,12,09,2018,00,00*72
$GNGBS,181605.00,,,,,,,*7A
$GNVTG,,,,,,,,,N*2E
$GNGNS,181606.00,,,,,NN,00,99.99,,,,*5B
$GNGGA,181606.00,,,,,0,00,99.99,,,,,,*70
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GPGSV,4,1,13,02,35,291,,03,09,129,,05,14,305,,06,38,226,*7D
$GPGSV,4,2,13,07,56,177,,09,70,067,17,16,20,055,,23,41,076,*71
$GPGSV,4,3,13,26,10,030,,29,05,341,,30,26,199,,36,30,158,*7E
$GPGSV,4,4,13,49,32,192,*4D
$GLGSV,3,1,10,66,45,091,,67,67,334,,68,17,297,,75,13,024,*69
$GLGSV,3,2,10,76,49,058,,77,40,156,,78,00,183,,82,15,246,*69
$GLGSV,3,3,10,83,28,298,,84,10,352,*6F
$GNGLL,,,,,181606.00,V,N*5C
$GNGRS,181606.00,1,,,,,,,,,,,,*58
$GNGRS,181606.00,1,,,,,,,,,,,,*58
$GNGST,181606.00,0.0000,,,,5773795,5773795,5773795*4C
$GNZDA,181606.00,12,09,2018,00,00*71
$GNGBS,181606.00,,,,,,,*79
$GNVTG,,,,,,,,,N*2E
$GNGNS,181607.00,,,,,NN,00,99.99,,,,*5A
$GNGGA,181607.00,,,,,0,00,99.99,,,,,,*71
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GPGSV,4,1,13,02,35,291,,03,09,129,,05,14,305,,06,38,226,*7D
$GPGSV,4,2,13,07,56,177,,09,70,067,14,16,20,055,,23,41,076,*72
$GPGSV,4,3,13,26,10,030,,29,05,341,,30,26,199,,36,30,158,*7E
$GPGSV,4,4,13,49,32,192,*4D
$GLGSV,3,1,10,66,45,091,,67,67,334,,68,17,297,,75,13,024,*69
$GLGSV,3,2,10,76,49,058,,77,41,156,,78,00,183,,82,15,246,*68
$GLGSV,3,3,10,83,28,298,,84,10,352,*6F
$GNGLL,,,,,181607.00,V,N*5D
$GNGRS,181607.00,1,,,,,,,,,,,,*59
$GNGRS,181607.00,1,,,,,,,,,,,,*59
$GNGST,181607.00,0.0000,,,,5773795,5773795,5773795*4D
$GNZDA,181607.00,12,09,2018,00,00*70
$GNGBS,181607.00,,,,,,,*78
$GNVTG,,,,,,,,,N*2E
$GNGNS,181608.00,,,,,NN,00,99.99,,,,*55
$GNGGA,181608.00,,,,,0,00,99.99,,,,,,*7E
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GPGSV,4,1,13,02,35,291,,03,09,129,,05,14,305,,06,38,226,*7D
$GPGSV,4,2,13,07,56,177,,09,70,067,12,16,20,055,,23,41,076,*74
$GPGSV,4,3,13,26,10,030,,29,05,341,,30,26,199,,36,30,158,*7E
$GPGSV,4,4,13,49,32,192,*4D
$GLGSV,3,1,10,66,45,091,,67,67,334,,68,17,297,,75,13,024,*69
$GLGSV,3,2,10,76,49,058,,77,41,156,,78,00,183,,82,15,246,*68
$GLGSV,3,3,10,83,28,298,,84,10,352,*6F
$GNGLL,,,,,181608.00,V,N*52
$GNGRS,181608.00,1,,,,,,,,,,,,*56
$GNGRS,181608.00,1,,,,,,,,,,,,*56
$GNGST,181608.00,0.0000,,,,5773795,5773795,5773795*42
$GNZDA,181608.00,12,09,2018,00,00*7F
$GNGBS,181608.00,,,,,,,*77
$GNVTG,,,,,,,,,N*2E
$GNGNS,181609.00,,,,,NN,00,99.99,,,,*54
$GNGGA,181609.00,,,,,0,00,99.99,,,,,,*7F
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GPGSV,4,1,13,02,35,291,,03,09,129,,05,14,305,,06,38,226,*7D
$GPGSV,4,2,13,07,56,177,,09,70,067,11,16,20,055,,23,41,076,*77
$GPGSV,4,3,13,26,10,030,,29,05,341,,30,26,199,,36,30,158,*7E
$GPGSV,4,4,13,49,32,192,*4D
$GLGSV,3,1,10,66,45,091,,67,67,334,,68,17,297,,75,13,024,*69
$GLGSV,3,2,10,76,49,058,,77,41,156,,78,00,183,,82,14,246,*69
$GLGSV,3,3,10,83,28,298,,84,10,352,*6F
$GNGLL,,,,,181609.00,V,N*53
$GNGRS,181609.00,1,,,,,,,,,,,,*57
$GNGRS,181609.00,1,,,,,,,,,,,,*57
$GNGST,181609.00,0.0000,,,,5773795,5773796,5773795*40
$GNZDA,181609.00,12,09,2018,00,00*7E
$GNGBS,181609.00,,,,,,,*76
$GNVTG,,,,,,,,,N*2E
$GNGNS,181610.00,,,,,NN,00,99.99,,,,*5C
$GNGGA,181610.00,,,,,0,00,99.99,,,,,,*77
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GPGSV,4,1,13,02,35,291,,03,09,129,,05,14,305,,06,38,226,*7D
$GPGSV,4,2,13,07,56,177,,09,70,067,11,16,20,055,,23,41,076,*77
$GPGSV,4,3,13,26,10,030,,29,05,341,,30,26,199,,36,30,158,*7E
$GPGSV,4,4,13,49,32,192,*4D
$GLGSV,3,1,10,66,45,091,,67,67,334,,68,17,297,,75,13,024,*69
$GLGSV,3,2,10,76,49,058,,77,41,156,,78,00,183,,82,14,246,*69
$GLGSV,3,3,10,83,28,297,,84,10,352,*60
$GNGLL,,,,,181610.00,V,N*5B
$GNGRS,181610.00,1,,,,,,,,,,,,*5F
$GNGRS,181610.00,1,,,,,,,,,,,,*5F
$GNGST,181610.00,0.0000,,,,5773796,5773796,5773795*4B
$GNZDA,181610.00,12,09,2018,00,00*76
$GNGBS,181610.00,,,,,,,*7E
$GNVTG,,,,,,,,,N*2E
$GNGNS,181611.00,,,,,NN,00,99.99,,,,*5D
$GNGGA,181611.00,,,,,0,00,99.99,,,,,,*76
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GPGSV,4,1,13,02,35,291,,03,09,129,,05,14,305,,06,38,226,*7D
$GPGSV,4,2,13,07,56,177,,09,70,067,11,16,20,055,,23,41,076,*77
$GPGSV,4,3,13,26,10,030,,29,05,341,,30,26,199,,36,30,158,*7E
$GPGSV,4,4,13,49,32,192,*4D
$GLGSV,3,1,10,66,45,091,,67,67,334,,68,17,297,,75,13,024,*69
$GLGSV,3,2,10,76,49,058,,77,41,156,,78,00,183,,82,14,246,*69
$GLGSV,3,3,10,83,28,297,,84,10,352,*60
$GNGLL,,,,,181611.00,V,N*5A
$GNGRS,181611.00,1,,,,,,,,,,,,*5E
$GNGRS,181611.00,1,,,,,,,,,,,,*5E
$GNGST,181611.00,0.0000,,,,5773796,5773796,5773796*49
$GNZDA,181611.00,12,09,2018,00,00*77
$GNGBS,181611.00,,,,,,,*7F
$GNVTG,,,,,,,,,N*2E
$GNGNS,181612.00,,,,,NN,00,99.99,,,,*5E
$GNGGA,181612.00,,,,,0,00,99.99,,,,,,*75
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GNGSA,A,1,,,,,,,,,,,,,99.99,99.99,99.99*2E
$GPGSV,4,1,13,02,35,291,,03,09,129,,05,14,305,,06,38,226,*7D
$GPGSV,4,2,13,07,56,177,,09,70,067,11,16,20,055,,23,41,076,*77
$GPGSV,4,3,13,26,10,030,,29,05,341,,30,26,199,,36,30,158,*7E
$GPGSV,4,4,13,49,32,192,*4D
$GLGSV,3,1,10,66,45,091,,67,67,334,,68,17,297,,75,13,024,*69
$GLGSV,3,2,10,76,49,058,,77,41,156,,78,00,183,,82,14,246,*69
$GLGSV,3,3,10,83,28,297,,84,10,352,*60
$GNGLL,,,,,181612.00,V,N*59
$GNGRS,181612.00,1,,,,,,,,,,,,*5D
$GNGRS,181612.00,1,,,,,,,,,,,,*5D
$GNGST,181612.00,0.0000,,,,5773796,5773796,5773796*4A
$GNZDA,181612.00,12,09,2018,00,00*74
$GNGBS,181612.00,,,,,,,*7C
"#;


